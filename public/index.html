<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Zulu Flight Timeline</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #111;
      color: #eee;
      padding: 40px;
      max-width: 700px;
      margin: auto;
    }
    label {
      display: block;
      margin-top: 20px;
    }
    input, button {
      margin-top: 5px;
      padding: 8px;
      font-size: 1rem;
      width: 100%;
    }
    button {
      margin-top: 25px;
      cursor: pointer;
    }
    table {
      margin-top: 30px;
      width: 100%;
      border-collapse: collapse;
    }
    td {
      padding: 8px;
      border-bottom: 1px solid #333;
    }
    td:first-child {
      font-weight: 600;
    }
  </style>
</head>
<body>

  <h1>Flight Timeline (Zulu)</h1>

  <label>
    Takeoff Time (Z)
    <input type="time" id="takeoff">
  </label>

  <label>
    Estimated Landing Time (Z)
    <input type="time" id="landing">
  </label>

  <button onclick="calculate()">Calculate Timeline</button>

  <div id="output"></div>

  <script>
    // Convert HH:MM to minutes since midnight
    function toMinutes(time) {
      const [h, m] = time.split(':').map(Number);
      return h * 60 + m;
    }

    // Convert minutes to HH:MM Zulu, wrapping around midnight
    function formatTime(mins) {
      mins = (mins + 1440) % 1440;
      const h = Math.floor(mins / 60);
      const m = mins % 60;
      return `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}Z`;
    }

    function calculate() {
      const takeoffVal = document.getElementById('takeoff').value;
      const landingVal = document.getElementById('landing').value;

      if (!takeoffVal || !landingVal) {
        document.getElementById('output').textContent =
          "Please enter both takeoff and landing times.";
        return;
      }

      const takeoff = toMinutes(takeoffVal);
      let landing = toMinutes(landingVal);

      if (landing < takeoff) {
        landing += 1440;
      }

      const timeline = [
        { label: "Enter Crew Rest", offset: -975 },   // 16:15
        { label: "Legal for Alert", offset: -255 },   // 4:15
        { label: "Show Time", offset: -195 },         // 3:15
        { label: "Brief Time", offset: -150 },        // 2:30
        { label: "Step Time", offset: -120 },         // 2:00
        { label: "Engine Start", offset: -30 },       // 0:30
        { label: "Takeoff Time", offset: 0 },
        { label: "Estimated Land Time", absolute: landing }
      ];

      let rows = "";

      for (const event of timeline) {
        let time;
        if (event.absolute !== undefined) {
          time = formatTime(event.absolute);
        } else {
          time = formatTime(takeoff + event.offset);
        }
        rows += `<tr><td>${event.label}</td><td>${time}</td></tr>`;
      }

      document.getElementById('output').innerHTML = `
        <table>
          ${rows}
        </table>
      `;
    }
  </script>

</body>
</html>
